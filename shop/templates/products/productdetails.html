{% extends "main_template.html" %}

{% load render_partial %}

{% block title %}.
صفحهی محصول
{% endblock title %}

{% load humanize %}

{% block content %}

<div id="r1">

  <main class="mt-0 md:mt-8">
    <div class="px-4 md:px-8 md:mt-10 pb-20">
      <div class="flex flex-col lg:flex-row gap-8">
        <!-- photo -->
        <div class="lg:w-4/12">
          <div class="flex gap-x-5 pr-10">

            <a href onclick="wishlist({{product.id}})"  class="relative">
              <div
                class="group cursor-pointer relative inline-block text-center">

                <svg  class="fill-zinc-700 hover:fill-red-400 transition"
                  xmlns="http://www.w3.org/2000/svg" width="26" height="26" fill
                  viewBox="0 0 256 256"><path
                    d="M178,32c-20.65,0-38.73,8.88-50,23.89C116.73,40.88,98.65,32,78,32A62.07,62.07,0,0,0,16,94c0,70,103.79,126.66,108.21,129a8,8,0,0,0,7.58,0C136.21,220.66,240,164,240,94A62.07,62.07,0,0,0,178,32ZM128,206.8C109.74,196.16,32,147.69,32,94A46.06,46.06,0,0,1,78,48c19.45,0,35.78,10.36,42.6,27a8,8,0,0,0,14.8,0c6.82-16.67,23.15-27,42.6-27a46.06,46.06,0,0,1,46,46C224,147.61,146.24,196.15,128,206.8Z"></path></svg>
                <div
                  class="opacity-0 w-28 transition-all bg-zinc-800 text-white text-center text-xs rounded-lg py-2 absolute z-10 -left-11 group-hover:opacity-100 px-3 pointer-events-none">
                  افزودن به علاقه مندی ها
                  <svg
                    class="absolute text-black h-2 w-full left-0 bottom-full rotate-180"
                    x="0px" y="0px" viewBox="0 0 255 255"
                    xml:space="preserve"><polygon class="fill-current"
                      points="0,0 127.5,127.5 255,0"></polygon></svg>
                </div>
              </div>
            </a>
            <a href="#" class="relative" onclick="copyToClipboard(event)">
              <div
                class="group cursor-pointer relative inline-block text-center">
                <svg class="fill-zinc-700 hover:fill-zinc-800 transition"
                  xmlns="http://www.w3.org/2000/svg" width="26" height="26"
                  viewBox="0 0 256 256">
                  <path
                    d="M176,160a39.89,39.89,0,0,0-28.62,12.09l-46.1-29.63a39.8,39.8,0,0,0,0-28.92l46.1-29.63a40,40,0,1,0-8.66-13.45l-46.1,29.63a40,40,0,1,0,0,55.82l46.1,29.63A40,40,0,1,0,176,160Zm0-128a24,24,0,1,1-24,24A24,24,0,0,1,176,32ZM64,152a24,24,0,1,1,24-24A24,24,0,0,1,64,152Zm112,72a24,24,0,1,1,24-24A24,24,0,0,1,176,224Z"></path>
                </svg>
                <div
                  class="opacity-0 w-28 transition-all bg-zinc-800 text-white text-center text-xs rounded-lg py-2 absolute z-10 -left-11 group-hover:opacity-100 px-3 pointer-events-none">
                  اشتراک گذاری
                  <svg
                    class="absolute text-black h-2 w-full left-0 bottom-full rotate-180"
                    x="0px" y="0px" viewBox="0 0 255 255">
                    <polygon class="fill-current"
                      points="0,0 127.5,127.5 255,0"></polygon>
                  </svg>
                </div>
              </div>
            </a>
          </div>
          <div class="relative">
            <div class="flex gap-4 justify-center">
              <div id="zoomBox"
                class="hidden absolute -left-56 top-0 md:size-64 bg-no-repeat bg-cover border-2 border-gray-300 rounded-md bg-white"></div>
              <div class="relative overflow-hidden group">
                <img id="mainImage" src="{{media_url}}{{product.image_name}}"
                  class="w-full max-w-96 object-cover rounded-lg"
                  alt="عکس محصول">
                <div id="zoomLens"
                  class="hidden absolute w-20 h-20 bg-gray-300 opacity-30 pointer-events-none"></div>
              </div>
            </div>
            <div class="flex justify-start gap-2 mt-4 overflow-x-auto">
              {% for image in images %}
              <img src="{{media_url}}{{image.image_name}}"
                class="w-20 h-20 object-cover rounded-md cursor-pointer border border-zinc-200 hover:border-zinc-400 opacity-80 hover:opacity-100 transition-all"
                onclick="changeImage(this)">
              {% endfor %}
            </div>
          </div>
        </div>
        <!-- info -->
        <div class="lg:w-5/12">
          <div
            class="mb-7 text-xs flex flex-wrap space-y-2 md:space-y-0 items-center gap-x-2 opacity-90">
            <a href class="text-zinc-500 hover:text-primary-500 transition">
              کالای دیجیتال
            </a>
            <svg class="size-3 fill-zinc-500" xmlns="http://www.w3.org/2000/svg"
              width="16" height="16" fill="#3d3d3d" viewBox="0 0 256 256"><path
                d="M165.66,202.34a8,8,0,0,1-11.32,11.32l-80-80a8,8,0,0,1,0-11.32l80-80a8,8,0,0,1,11.32,11.32L91.31,128Z"></path></svg>
            <a href class="text-zinc-500 hover:text-primary-500 transition">
              موبایل
            </a>
            <svg class="size-3 fill-zinc-500" xmlns="http://www.w3.org/2000/svg"
              width="16" height="16" fill="#3d3d3d" viewBox="0 0 256 256"><path
                d="M165.66,202.34a8,8,0,0,1-11.32,11.32l-80-80a8,8,0,0,1,0-11.32l80-80a8,8,0,0,1,11.32,11.32L91.31,128Z"></path></svg>
            <a class="text-primary-500" href>
              {{product.product_name}}
            </a>
          </div>
          <div class="text-zinc-800 md:text-2xl font-semibold leading-7">
            {{product.product_name}}
          </div>

          <div class="mt-8 text-zinc-700">
            ویژگی های محصول:
          </div>
          <div class="grid grid-cols-2 md:grid-cols-3 max-w-md py-3 mb-5 gap-3">
            {% for item in features %}
            <div
              class="flex flex-col gap-x-2 justufy-center bg-gray-100 rounded-md px-2 py-3">
              <div class="text-zinc-500 text-xs">
                {{item.feature}}:
              </div>
              <div class="text-zinc-700 text-sm">
                {{item.value}}
              </div>
            </div>
            {% endfor %}
          </div>
          <div
            class="flex gap-x-2 mt-2 pt-2 text-zinc-500 text-xs md:text-sm border-t border-t-zinc-200 leading-6">
            <svg class="fill-zinc-500" xmlns="http://www.w3.org/2000/svg"
              width="24" height="24" fill viewBox="0 0 256 256"><path
                d="M128,24A104,104,0,1,0,232,128,104.11,104.11,0,0,0,128,24Zm0,192a88,88,0,1,1,88-88A88.1,88.1,0,0,1,128,216Zm16-40a8,8,0,0,1-8,8,16,16,0,0,1-16-16V128a8,8,0,0,1,0-16,16,16,0,0,1,16,16v40A8,8,0,0,1,144,176ZM112,84a12,12,0,1,1,12,12A12,12,0,0,1,112,84Z"></path></svg>
            درخواست مرجوع کردن کالا در گروه لپ تاپ با دلیل "انصراف از خرید" تنها
            در صورتی قابل تایید است که کالا در شرایط اولیه باشد (در صورت پلمپ
            بودن، کالا نباید باز شده باشد).
          </div>
        </div>
        <!-- buy -->
        <div class="lg:w-3/12">

          <div
            class="p-3 border border-zinc-300 rounded-xl mx-auto divide-y divide-zinc-200">
            <div
              class="flex gap-x-1 items-center text-zinc-600 text-sm pb-5 pt-3">
              <svg class="fill-zinc-700" xmlns="http://www.w3.org/2000/svg"
                width="20" height="20" fill viewBox="0 0 256 256"><path
                  d="M208,40H48A16,16,0,0,0,32,56v58.78c0,89.61,75.82,119.34,91,124.39a15.53,15.53,0,0,0,10,0c15.2-5.05,91-34.78,91-124.39V56A16,16,0,0,0,208,40Zm0,74.79c0,78.42-66.35,104.62-80,109.18-13.53-4.51-80-30.69-80-109.18V56H208ZM82.34,141.66a8,8,0,0,1,11.32-11.32L112,148.68l50.34-50.34a8,8,0,0,1,11.32,11.32l-56,56a8,8,0,0,1-11.32,0Z"></path></svg>
              <div>
                گارانتی {{product.warranty}} ماهه
              </div>
            </div>
            <div class="flex gap-x-1 items-center text-zinc-600 text-sm py-5">
              <svg class="fill-zinc-700" xmlns="http://www.w3.org/2000/svg"
                width="20" height="20" fill viewBox="0 0 256 256"><path
                  d="M247.42,117l-14-35A15.93,15.93,0,0,0,218.58,72H184V64a8,8,0,0,0-8-8H24A16,16,0,0,0,8,72V184a16,16,0,0,0,16,16H41a32,32,0,0,0,62,0h50a32,32,0,0,0,62,0h17a16,16,0,0,0,16-16V120A7.94,7.94,0,0,0,247.42,117ZM184,88h34.58l9.6,24H184ZM24,72H168v64H24ZM72,208a16,16,0,1,1,16-16A16,16,0,0,1,72,208Zm81-24H103a32,32,0,0,0-62,0H24V152H168v12.31A32.11,32.11,0,0,0,153,184Zm31,24a16,16,0,1,1,16-16A16,16,0,0,1,184,208Zm48-24H215a32.06,32.06,0,0,0-31-24V128h48Z"></path></svg>
              <div>
                ارسال 2 روز کاری
              </div>
            </div>
    
            <div class="flex flex-col justify-center py-5">
              <div class="text-zinc-800 text-left">
                {% if product.get_price_by_discounts < product.price %}
                <span
                  class="font-yekanBakhExtraBold text-3xl">{{product.get_price_by_discounts|intcomma}}</span>
                <del class="relative top-[0.15em] decoration-red-500 decoration-2" ><span class="font-yekanBakhExtraBold text-3xl">{{product.price|intcomma}}</span></del>
                <span class="text-xs">تومان</span>
                {% else %}
                <span
                  class="font-yekanBakhExtraBold text-3xl">{{product.price|intcomma}}</span>
                <span class="text-xs">تومان</span>
                {% endif %}
              </div>
              <div class="text-xs text-red-400">
                تنها 2 عدد در انبار باقی مانده
              </div>
              <div
                class="quantity-container mt-5 flex h-10 w-full items-center justify-between rounded-lg border border-gray-100 px-2 py-1">
                <button class="cursor-pointer" type="button"
                  data-action="increment">
                  <svg class="fill-green-500 size-5"
                    xmlns="http://www.w3.org/2000/svg" width="18" height="18"
                    viewBox="0 0 256 256"><path
                      d="M222,128a6,6,0,0,1-6,6H134v82a6,6,0,0,1-12,0V134H40a6,6,0,0,1,0-12h82V40a6,6,0,0,1,12,0v82h82A6,6,0,0,1,222,128Z"></path></svg>
                </button>
                <input value="1" disabled type="number" id="product_input"
                  class="flex h-5 w-full grow select-none items-center justify-center bg-transparent text-center text-sm md:text-lg font-yekanBakhExtraBold text-zinc-600 outline-none">
                <button class="cursor-pointer" type="button"
                  data-action="decrement">
                  <svg class="fill-red-500 size-5"
                    xmlns="http://www.w3.org/2000/svg" width="18" height="18"
                    viewBox="0 0 256 256"><path
                      d="M222,128a6,6,0,0,1-6,6H40a6,6,0,0,1,0-12H216A6,6,0,0,1,222,128Z"></path></svg>
                </button>
              </div>
            </div>
            {% if user.is_authenticated %}
            <button onclick="add_to_shop_cart({{product.id}},0)"
              class="hidden lg:block mx-auto cursor-pointer w-full px-2 py-3 text-sm bg-gradient-to-bl from-primary-500 to-primary-400 hover:opacity-90 transition text-gray-100 rounded-lg">
              افزودن به سبد خرید
            </button>
            {% else %}
            <button 
              class="hidden lg:block mx-auto cursor-pointer w-full px-2 py-3 text-sm bg-gradient-to-bl from-primary-500 to-primary-400 hover:opacity-90 transition text-gray-100 rounded-lg">
                برای خرید ابتدا وارد شوید 
            </button>
            {% endif %}
            <!-- <button class="hidden lg:block mx-auto w-full px-2 py-3 text-sm bg-gradient-to-bl from-primary-500 to-primary-400 opacity-80 cursor-not-allowed transition text-gray-100 rounded-lg">
              محصول موجود نیست!
            </button> -->
          </div>
          <!-- fixed div buy mobile -->
          <div
            class="fixed flex bottom-0 right-0 lg:hidden bg-white border-t border-t-zinc-300 w-full px-5 py-3 gap-x-2 z-50">
            <button
              class="mx-auto 5 w-1/2 px-2 py-3 text-sm bg-gradient-to-bl from-primary-500 to-primary-400 hover:opacity-90 transition text-gray-100 rounded-lg">
              افزودن به سبد خرید
            </button>
            <!-- <button class="mx-auto 5 w-1/2 px-2 py-3 text-sm bg-gradient-to-bl from-primary-500 to-primary-400 opacity-80 cursor-not-allowed transition text-gray-100 rounded-lg">
              محصول موجود نیست!
            </button> -->
            <span class="flex flex-col justify-center items-end w-1/2">
              <div class="text-zinc-700 text-left">
                <span class="font-yekanBakhExtraBold text-2xl">1,200,000</span>
                <span class="text-xs">تومان</span>
              </div>
              <div class="text-xs text-red-400">
                تنها 2 عدد در انبار باقی مانده
              </div>
            </span>
          </div>
        </div>
      </div>
      <div class="flex gap-x-8 mt-20 pb-2 border-b border-zinc-200">
        <a class="text-zinc-600 hover:text-zinc-800 transition" href="#details">
          توضیحات
        </a>
        <a class="text-zinc-600 hover:text-zinc-800 transition" href="#proper">
          مشخصات
        </a>

      </div>
      <div class="p-4 border-b border-zinc-200" id="details">
        <p class="text-zinc-800 md:text-lg mb-1 mt-4">
          توضیحات این محصول
        </p>
        <p class="text-zinc-600 text-xs md:text-sm leading-8 my-2">
          {{product.description}}
        </p>

      </div>
      <div class="p-4 border-b border-zinc-200" id="proper">
        <p class="text-zinc-800 md:text-lg mb-1 mt-4">
          مشخصات محصول
        </p>
        <div class="text-gray-500 text-sm divide-y divide-zinc-200">
          {% for item in features %}
          <div class="flex items-center justify-start p-3 pb-6 w-full my-4">
            <div
              class="text-sm md:text-basetext-zinc-700 w-3/12 font-yekanBakhRegular">
              {{item.feature}}
            </div>
            <div
              class="md:text-lg text-zinc-600 w-9/12 font-yekanBakhExtraBold">
              {{item.value}}
            </div>
          </div>
          {% endfor %}
        </div>
      </div>

      {% render_partial "products:releated_products" slug=product.slug %}
    </div>
  </main>

</div>

{% endblock content %}
